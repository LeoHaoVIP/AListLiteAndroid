import{B as g,av as U,D as t,ao as D,S as v,ax as q,U as _,K as H,ac as x,aW as K,aB as M,o as Y,ay as S,a_ as f,cp as G,ee as b,ad as O,ab as y,ef as Q,cY as X,a5 as Z}from"./index-BuiRiVor.js";import{V as ee,a as te}from"./index-6urWlYXR.js";var re=S('<div style=padding:20px;overflow:auto><table style="border-collapse:collapse;width:100%;background-color:white;box-shadow:0 2px 8px rgba(0,0,0,0.1)"><tbody>'),ne=S("<div style=width:100%;height:100%;overflow:auto;position:relative;background:#ffffff;padding-top:50px>"),oe=S("<tr>"),ae=S('<td style="border:1px solid #ddd;padding:8px 12px;white-space:pre-wrap;word-break:break-word;min-width:100px">');const ie=()=>{const E=Y(),[C,F]=g(!0),[$,B]=g(!1),[j,I]=g(!1),[p,N]=g([]),[J,R]=g(0);let w;const T=()=>new Promise((r,o)=>{if(window.ExcelJS){r();return}const l=document.getElementById("exceljs-script");if(l){l.addEventListener("load",()=>r()),l.addEventListener("error",()=>o(new y("Failed to load ExcelJS library")));return}const a=document.createElement("script");a.src="https://res.oplist.org.cn/exceljs/exceljs.min.js",a.id="exceljs-script",a.async=!0,a.onload=()=>r(),a.onerror=()=>o(new y("Failed to load ExcelJS library")),document.head.appendChild(a)}),A=async()=>{try{F(!0),B(!1),await T();const r=Z.raw_url,o=await fetch(r);if(!o.ok)throw new y("Failed to fetch Excel file");const l=await o.arrayBuffer(),a=new window.ExcelJS.Workbook;await a.xlsx.load(l);const m=[];a.worksheets.forEach(c=>{const h=[];c.eachRow((s,u)=>{const n=[];s.eachCell({includeEmpty:!0},(e,k)=>{let d="";e.value!==null&&e.value!==void 0&&(typeof e.value=="object"&&"text"in e.value?d=e.value.text:typeof e.value=="object"&&"result"in e.value?d=String(e.value.result):d=String(e.value));const i={};e.font&&(i.bold=e.font.bold,i.italic=e.font.italic),e.fill&&e.fill.fgColor&&(i.bgColor=e.fill.fgColor.argb),e.alignment&&(i.alignment=e.alignment.horizontal||"left"),n.push({value:d,style:i})}),h.push(n)}),m.push({name:c.name,rows:h})}),N(m),F(!1)}catch(r){console.error("Excel加载失败:",r),B(!0),F(!1)}},P=()=>{w&&(document.fullscreenElement?document.exitFullscreen().then(()=>{I(!1)}):w.requestFullscreen().then(()=>{I(!0)}))};return U(()=>{A()}),t(X,{w:"$full",h:"70vh",pos:"relative",get children(){return[t(D,{pos:"absolute",top:"$2",left:"$2",right:"$2",zIndex:"10",display:"flex",justifyContent:"space-between",alignItems:"center",px:"$2",get children(){return[t(v,{get when(){return x(()=>!C()&&!$())()&&p().length>0},get children(){return t(q,{spacing:"$2",flexWrap:"wrap",get children(){return t(_,{get each(){return p()},children:(r,o)=>t(H,{size:"sm",get variant(){return J()===o()?"solid":"outline"},colorScheme:"primary",onClick:()=>R(o()),get children(){return r.name}})})}})}}),t(D,{opacity:"0.7",transition:"opacity 0.2s",_hover:{opacity:"1"},get children(){return t(K,{withArrow:!0,get label(){return x(()=>!!j())()?E("home.preview.exit_fullscreen"):E("home.preview.fullscreen")},get children(){return t(M,{size:"sm",colorScheme:"neutral","aria-label":"Toggle Fullscreen",get icon(){return x(()=>!!j())()?t(ee,{}):t(te,{})},onClick:P})}})}})]}}),(()=>{var r=ne(),o=w;return typeof o=="function"?Q(o,r):w=r,f(r,t(v,{get when(){return x(()=>!C()&&!$())()&&p().length>0},get children(){var l=re(),a=l.firstChild,m=a.firstChild;return f(m,t(_,{get each(){var c;return((c=p()[J()])==null?void 0:c.rows)||[]},children:c=>(()=>{var h=oe();return f(h,t(_,{each:c,children:s=>(()=>{var u=ae();return f(u,()=>s.value),G(n=>{var V,z,L,W;var e=(V=s.style)!=null&&V.bold?"bold":"normal",k=(z=s.style)!=null&&z.italic?"italic":"normal",d=(L=s.style)!=null&&L.bgColor?"#".concat(s.style.bgColor.slice(2)):"transparent",i=((W=s.style)==null?void 0:W.alignment)||"left";return e!==n.e&&b(u,"font-weight",n.e=e),k!==n.t&&b(u,"font-style",n.t=k),d!==n.a&&b(u,"background-color",n.a=d),i!==n.o&&b(u,"text-align",n.o=i),n},{e:void 0,t:void 0,a:void 0,o:void 0}),u})()})),h})()})),l}}),null),f(r,t(v,{get when(){return C()},get children(){return t(O,{})}}),null),f(r,t(v,{get when(){return $()},get children(){return t(y,{get msg(){return E("preview.failed_load_excel")},h:"70vh"})}}),null),r})()]}})};export{ie as default};

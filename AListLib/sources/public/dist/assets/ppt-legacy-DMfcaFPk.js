System.register(["./index-legacy-C7GeLJzS.js","./index-legacy-B3HW6xxC.js"],function(e,t){"use strict";var r,n,i,s,l,o,a,d,c,u,p,h,m,w,f,y,g,v,j,x,$;return{setters:[e=>{r=e.C,n=e.aw,i=e.P,s=e.E,l=e.ap,o=e.aX,a=e.aC,d=e.ad,c=e.q,u=e.az,p=e.a$,h=e.S,m=e.ae,w=e.ac,f=e.cq,y=e.ef,g=e.eg,v=e.cZ,j=e.a6},e=>{x=e.V,$=e.a}],execute:function(){var t=u("<div style=width:100%;height:100%;overflow:auto;position:relative;background:#f5f5f5><div id=ppt-result style=width:100%;height:100%>");e("default",()=>{const e=c(),[u,S]=r(!0),[E,C]=r(!1),[k,P]=r(!1);let T,q;const b=(e,t)=>new Promise((r,n)=>{if(document.getElementById(t))return void r();const i=document.createElement("script");i.src=e,i.id=t,i.type="text/javascript",i.onload=()=>r(),i.onerror=()=>n(new w(`Failed to load script: ${e}`)),document.head.appendChild(i)}),z=(e,t)=>new Promise((r,n)=>{if(document.getElementById(t))return void r();const i=document.createElement("link");i.rel="stylesheet",i.href=e,i.id=t,i.onload=()=>r(),i.onerror=()=>n(new w(`Failed to load CSS: ${e}`)),document.head.appendChild(i)}),F=()=>{T&&(document.fullscreenElement?document.exitFullscreen().then(()=>{P(!1),q&&q.querySelectorAll(".slide").forEach(e=>{e.style.width="",e.style.margin=""})}):T.requestFullscreen().then(()=>{P(!0),q&&q.querySelectorAll(".slide").forEach(e=>{e.style.width="99%",e.style.margin="0 auto"})}))},A=()=>{!document.fullscreenElement&&(P(!1),q)&&q.querySelectorAll(".slide").forEach(e=>{e.style.width="",e.style.margin=""})};return n(()=>{(async()=>{try{S(!0),C(!1);const e="https://res.oplist.org.cn/ppt.js";if(await Promise.all([z(`${e}/css/pptxjs.css`,"pptxjs-css"),z(`${e}/css/nv.d3.min.css`,"nv-d3-css")]),await b(`${e}/js/jquery-1.11.3.min.js`,"jquery-script"),await b("https://unpkg.com/jszip@2.6.1/dist/jszip.min.js","jszip-script"),await b(`${e}/js/filereader.js`,"filereader-script"),await b(`${e}/js/d3.min.js`,"d3-script"),await b(`${e}/js/nv.d3.min.js`,"nv-d3-script"),await b(`${e}/js/pptxjs.js`,"pptxjs-script"),await b(`${e}/js/divs2slides.js`,"divs2slides-script"),!window.$||!window.jQuery)throw new w("jQuery not loaded");q&&(window.$(q).pptxToHtml({pptxFileUrl:j.raw_url,slideMode:!1,keyBoardShortCut:!1,slideModeConfig:{first:1,nav:!1,navTxtColor:"white",navNextTxt:"&#8250;",navPrevTxt:"&#8249;",showPlayPauseBtn:!1,keyBoardShortCut:!1,showSlideNum:!1,showTotalSlideNum:!1,autoSlide:!1,randomAutoSlide:!1,loop:!1,background:"black",transition:"default",transitionTime:1}}),setTimeout(()=>{S(!1)},2e3))}catch(e){console.error("PPT初始化失败:",e),C(!0),S(!1)}})(),document.addEventListener("fullscreenchange",A)}),i(()=>{document.removeEventListener("fullscreenchange",A)}),s(v,{w:"$full",h:"70vh",pos:"relative",get children(){return[s(l,{pos:"absolute",top:"$2",right:"$2",zIndex:"10",opacity:"0.7",transition:"opacity 0.2s",_hover:{opacity:"1"},get children(){return s(o,{withArrow:!0,get label(){return d(()=>!!k())()?e("home.preview.exit_fullscreen"):e("home.preview.fullscreen")},get children(){return s(a,{size:"sm",colorScheme:"neutral","aria-label":"Toggle Fullscreen",get icon(){return d(()=>!!k())()?s(x,{}):s($,{})},onClick:F})}})}}),(r=t(),n=r.firstChild,"function"==typeof T?g(T,r):T=r,"function"==typeof q?g(q,n):q=n,p(r,s(h,{get when(){return u()},get children(){return s(m,{})}}),null),p(r,s(h,{get when(){return E()},get children(){return s(w,{get msg(){return e("preview.failed_load_ppt")},h:"70vh"})}}),null),f(e=>y(n,"display",u()||E()?"none":"block")),r)];var r,n}})})}}});

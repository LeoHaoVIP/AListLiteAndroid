import{j as v,B as c,e6 as E,a5 as s,av as L,O as R,ay as j,a_ as u,D as l,ad as C,S as w,ab as P,o as _}from"./index-BuiRiVor.js";var b=j("<div id=swf-container style=position:relative;width:100%;height:75vh;display:flex;justify-content:center;align-items:center>");const I=()=>{const m=_(),{replace:i}=v(),[y,r]=c(!0),[h,a]=c(!1),{ruffleJSPath:g}=E();let n=s.objs.filter(t=>t.name.toLowerCase().endsWith(".swf"));n.length===0&&(n=[s.obj]);const d=t=>{const e=n.findIndex(o=>o.name===s.obj.name);t.key==="ArrowLeft"&&e>0?i(n[e-1].name):t.key==="ArrowRight"&&e<n.length-1&&i(n[e+1].name)};L(()=>{window.addEventListener("keydown",d),p()}),R(()=>{window.removeEventListener("keydown",d);const t=document.getElementById("ruffle-player");t==null||t.remove();const e=document.getElementById("ruffle-script");e==null||e.remove()});const p=()=>{r(!0),a(!1);const t=document.getElementById("ruffle-player");if(t==null||t.remove(),window.RufflePlayer){f();return}const e=document.createElement("script");e.src=g(),e.async=!0,e.id="ruffle-script",e.onload=()=>{f()},e.onerror=()=>{a(!0),r(!1),console.error("无法加载Ruffle播放器")},document.head.appendChild(e)},f=()=>{try{const e=window.RufflePlayer.newest().createPlayer();e.id="ruffle-player",e.style.width="100%",e.style.height="100%";const o=document.getElementById("swf-container");o&&(o.innerHTML="",o.appendChild(e),e.addEventListener("loaded",()=>{r(!1)}),e.addEventListener("error",()=>{a(!0),r(!1)}),e.load(s.raw_url))}catch(t){console.error("Ruffle初始化失败:",t),a(!0),r(!1)}};return(()=>{var t=b();return u(t,l(w,{get when(){return y()},get children(){return l(C,{})}}),null),u(t,l(w,{get when(){return h()},get children(){return l(P,{get msg(){return m("preview.failed_load_swf")},h:"75vh"})}}),null),t})()};export{I as default};

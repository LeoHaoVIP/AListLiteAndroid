import{C as f,aw as P,P as F,E as l,ap as T,aX as _,aC as k,ad as j,q as b,az as q,a$ as S,S as $,ae as B,ac as c,cq as z,ef as A,eg as x,cZ as I,a6 as V}from"./index-BFcje_PK.js";import{V as L,a as N}from"./index-LpOJCJG0.js";var M=q("<div style=width:100%;height:100%;overflow:auto;position:relative;background:#f5f5f5><div id=ppt-result style=width:100%;height:100%>");const U=()=>{const d=b(),[h,u]=f(!0),[m,w]=f(!1),[g,p]=f(!1);let i,r;const a=(e,t)=>new Promise((n,o)=>{if(document.getElementById(t)){n();return}const s=document.createElement("script");s.src=e,s.id=t,s.type="text/javascript",s.onload=()=>n(),s.onerror=()=>o(new c("Failed to load script: ".concat(e))),document.head.appendChild(s)}),y=(e,t)=>new Promise((n,o)=>{if(document.getElementById(t)){n();return}const s=document.createElement("link");s.rel="stylesheet",s.href=e,s.id=t,s.onload=()=>n(),s.onerror=()=>o(new c("Failed to load CSS: ".concat(e))),document.head.appendChild(s)}),C=async()=>{try{u(!0),w(!1);const e="https://res.oplist.org.cn/ppt.js";if(await Promise.all([y("".concat(e,"/css/pptxjs.css"),"pptxjs-css"),y("".concat(e,"/css/nv.d3.min.css"),"nv-d3-css")]),await a("".concat(e,"/js/jquery-1.11.3.min.js"),"jquery-script"),await a("https://unpkg.com/jszip@2.6.1/dist/jszip.min.js","jszip-script"),await a("".concat(e,"/js/filereader.js"),"filereader-script"),await a("".concat(e,"/js/d3.min.js"),"d3-script"),await a("".concat(e,"/js/nv.d3.min.js"),"nv-d3-script"),await a("".concat(e,"/js/pptxjs.js"),"pptxjs-script"),await a("".concat(e,"/js/divs2slides.js"),"divs2slides-script"),!window.$||!window.jQuery)throw new c("jQuery not loaded");r&&(window.$(r).pptxToHtml({pptxFileUrl:V.raw_url,slideMode:!1,keyBoardShortCut:!1,slideModeConfig:{first:1,nav:!1,navTxtColor:"white",navNextTxt:"&#8250;",navPrevTxt:"&#8249;",showPlayPauseBtn:!1,keyBoardShortCut:!1,showSlideNum:!1,showTotalSlideNum:!1,autoSlide:!1,randomAutoSlide:!1,loop:!1,background:"black",transition:"default",transitionTime:1}}),setTimeout(()=>{u(!1)},2e3))}catch(e){console.error("PPT初始化失败:",e),w(!0),u(!1)}},E=()=>{i&&(document.fullscreenElement?document.exitFullscreen().then(()=>{p(!1),r&&r.querySelectorAll(".slide").forEach(t=>{t.style.width="",t.style.margin=""})}):i.requestFullscreen().then(()=>{p(!0),r&&r.querySelectorAll(".slide").forEach(t=>{t.style.width="99%",t.style.margin="0 auto"})}))},v=()=>{document.fullscreenElement||(p(!1),r&&r.querySelectorAll(".slide").forEach(t=>{t.style.width="",t.style.margin=""}))};return P(()=>{C(),document.addEventListener("fullscreenchange",v)}),F(()=>{document.removeEventListener("fullscreenchange",v)}),l(I,{w:"$full",h:"70vh",pos:"relative",get children(){return[l(T,{pos:"absolute",top:"$2",right:"$2",zIndex:"10",opacity:"0.7",transition:"opacity 0.2s",_hover:{opacity:"1"},get children(){return l(_,{withArrow:!0,get label(){return j(()=>!!g())()?d("home.preview.exit_fullscreen"):d("home.preview.fullscreen")},get children(){return l(k,{size:"sm",colorScheme:"neutral","aria-label":"Toggle Fullscreen",get icon(){return j(()=>!!g())()?l(L,{}):l(N,{})},onClick:E})}})}}),(()=>{var e=M(),t=e.firstChild,n=i;typeof n=="function"?x(n,e):i=e;var o=r;return typeof o=="function"?x(o,t):r=t,S(e,l($,{get when(){return h()},get children(){return l(B,{})}}),null),S(e,l($,{get when(){return m()},get children(){return l(c,{get msg(){return d("preview.failed_load_ppt")},h:"70vh"})}}),null),z(s=>A(t,"display",h()||m()?"none":"block")),e})()]}})};export{U as default};

System.register(["./index-legacy-C7GeLJzS.js","./icon-legacy-BAXJTbLN.js","./List-legacy-Bqx66p40.js","./index-legacy-BfhvY8g1.js","./File-legacy-BnjpUgLi.js","./Password-legacy-l-rCLVqH.js","./helper-legacy-CfKt6vc_.js","./style-legacy-CoBzhmVO.js","./Layout-legacy-1iblh3kn.js","./useTitle-legacy-HTPH2TsG.js","./FolderTree-legacy-C9HuwRat.js","./index-legacy-DDwAqkY0.js","./index-legacy-LqdxT-Xx.js","./share-legacy-CbQXMBg4.js","./index-legacy-Cyob4gap.js","./storage-legacy-DkpoUQ7j.js"],function(e,r){"use strict";var t,n,l,a,i,c,o,s,u,d,g,h,p,w,m,f,b,j,y,_,k,$,x,v,C,O,S,P,z,F,I,A,q,E,L,M,R,U,V,G,K,N,T,Y,B,D,J,Q,W,Z,H,X,ee,re,te,ne,le,ae,ie,ce,oe,se;return{setters:[e=>{t=e.k,n=e.an,l=e.bb,a=e.eh,i=e.ei,c=e.Q,o=e.C,s=e.D,u=e.a6,d=e.P,g=e.ej,h=e.E,p=e.a3,w=e.Y,m=e.Z,f=e.ad,b=e.V,j=e.a2,y=e.S,_=e.aa,k=e.ab,$=e.ac,x=e.ai,v=e.q,C=e.aj,O=e.a9,S=e.aK,P=e.ae,z=e.ay,F=e.bu,I=e.aq,A=e.ds,q=e.ek,E=e.bV,L=e.aO,M=e.aG,R=e.r,U=e.cF,V=e.cR,G=e.a1,K=e.ax,N=e.bW,T=e.cI,Y=e.aS,B=e.aY,D=e.a7,J=e.a8,Q=e._,W=e.aV},e=>{Z=e.O,H=e.g},e=>{X=e.L,ee=e.c},e=>{re=e.d,te=e.g},e=>{ne=e.g,le=e.O},e=>{ae=e.default},e=>{ie=e.u},e=>{ce=e.b,oe=e.x,se=e.w},null,null,null,null,null,null,null,null],execute:function(){const r=e=>{const{show:r}=ce({id:2}),{isMouseSupported:t}=ie(),n=()=>R.list_item_filename_overflow;return h(K.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},style:{width:"100%"},get children(){return h(z,{class:"list-item viselect-item",get"data-index"(){return e.index},w:"$full",p:"$2",rounded:"$lg",transition:"all 0.3s",get _hover(){return{transform:"scale(1.01)",bgColor:G()}},get cursor(){return t()?"default":"pointer"},"on:click":r=>{e.obj.is_dir?e.jumpCallback():!e.obj.is_dir&&e.onFileClick&&e.onFileClick()},onContextMenu:t=>{r(t,{props:e})},get children(){return[h(z,{class:"name-box",spacing:"$1",get w(){return ee[0].w},get children(){return[h(L,{class:"icon",boxSize:"$6",get color(){return M()},get as(){return H(e.obj)},mr:"$1"}),h(x,{class:"name",get css(){return{wordBreak:"break-all",whiteSpace:"multi_line"===n()?"unset":"nowrap","overflow-x":"scrollable"===n()?"auto":"hidden",textOverflow:"ellipsis"===n()?"ellipsis":"unset","scrollbar-width":"none","&::-webkit-scrollbar":{display:"none"}}},get title(){return e.obj.name},get children(){return e.obj.name}})]}}),h(x,{class:"size",get w(){return ee[1].w},get textAlign(){return ee[1].textAlign},get children(){return U(e.obj.size)}}),h(x,{class:"modified",display:{"@initial":"none","@md":"inline"},get w(){return ee[2].w},get textAlign(){return ee[2].textAlign},get children(){return V(e.obj.modified)}})]}})}})},ue={extract:{icon:te,color:"$success9"},copy_link:{icon:re,color:"$info9"},download:{icon:W,color:"$primary9"}},de=()=>{const{copy:e}=N(),{colorMode:r}=T(),{isShare:n}=t();return h(se,{id:2,animation:"scale",get theme(){return"dark"!==r()?"light":"dark"},style:"z-index: var(--hope-zIndices-popover)",get children(){return[h(oe,{hidden:({props:e})=>e.obj.is_dir,onClick:({props:e})=>{var r;r=e.url,window.open(r,"_blank")},get children(){return h(ge,{name:"download"})}}),h(oe,{hidden:({props:e})=>e.obj.is_dir,onClick:({props:r})=>{e(r.url)},get children(){return h(ge,{name:"copy_link"})}}),h(oe,{hidden:()=>{const e=B.findIndex(e=>"decompress"===e);return!n()&&!D.can(J(),e)},onClick:({props:e})=>{Y.emit("extract",JSON.stringify({inner:e.innerPath,pass:e.pass}))},get children(){return h(ge,{name:"extract"})}})]}})},ge=e=>{const r=v();return h(z,{spacing:"$2",get children(){return[h(L,{get p(){return ue[e.name].p?"$1":void 0},get as(){return ue[e.name].icon},boxSize:"$7",get color(){return ue[e.name].color}}),h(x,{get children(){return r(`home.toolbar.${e.name}`)}})]}})};e("default",()=>{const e=v(),{pathname:L}=t(),{rawLink:M}=n(),[R,U]=l(a),[V,G]=l(i),K=c(()=>R()||V());let N="",T="",Y="",B=null;const[D,J]=o(""),[W,H]=o(!1),[ee,re]=o(!1),[te,ie]=o(""),[ce,oe]=o([]),[se,ue]=o(),[ge,he]=o(!1),[pe,we]=o(""),[me,fe]=o(""),[be,je]=o(""),ye=function(){let e=!1,r=[];return{acquire:()=>new Promise(t=>{e?r.push(t):(e=!0,t())}),release:()=>{r.length>0?r.shift()():e=!1}}}(),_e=e=>{let r={};return e.forEach(e=>{r[e.name]={...e,children:e.children?_e(e.children):null}}),r},ke=e=>200!==e.code&&(202===e.code?E(()=>{""!==N&&H(!0),re(!0),J("")}):J(e.message),!0),$e=async e=>{if(await ye.acquire(),ee()&&""===N)return ye.release(),[];if(""===T){const e=await U(L(),Q(),N);if(ke(e))return ye.release(),[];if(null!==e.data.content&&(B=_e(e.data.content)),T=e.data.raw_url,Y=e.data.sign,ie(e.data.comment),void 0!==e.data.sort){let r;""!==e.data.sort.order_by&&(r=e.data.sort.order_by);let t="desc"===e.data.sort.order_direction,n=e.data.sort.extract_folder;E(()=>{ue(r),he(t),we(n)})}if(e.data.encrypted&&""===N)return E(()=>{re(!0),J("")}),ye.release(),[]}if(null===B){const e=await G(L(),Q(),N,"/");if(ke(e))return ye.release(),[];B=_e(e.data.content)}let r=B;for(let t=0;t<e.length;t++){if(null===r[e[t]].children){const n=await G(L(),Q(),N,"/"+e.slice(0,t+1).join("/"));if(ke(n))return ye.release(),[];r[e[t]].children=_e(n.data.content)}r=r[e[t]].children}return E(()=>{re(!1),H(!1),J("")}),ye.release(),Object.values(r)},[xe,ve]=o([]);s(()=>{$e(ce()).then(e=>ve(e))});const Ce=()=>{$e(ce()).then(e=>ve(e))};Ce();const Oe=()=>{let e=xe();se()&&(e=e.sort((e,r)=>(ge()?-1:1)*q(e[se()],r[se()])));let r=pe();if(""!==r){let t=[],n=[];e.forEach(e=>(e.is_dir?t:n).push(e)),e="front"===r?t.concat(n):n.concat(t)}return e},Se=e=>{const r=ce().length>0?"/"+ce().join("/"):"";return{...e,sign:Y,inner_path:r,archive:Ae}},Pe=(e,r)=>{E(()=>{we(""),ue(e),void 0!==r&&he(r)})},ze=c(()=>Oe().filter(e=>!e.is_dir).map(e=>Se(e))),Fe=c(()=>{const e=ze().find(e=>e.name===me());return e?ne({...e,provider:u.provider}):[]}),Ie=c(()=>{const e=Fe();if(0===e.length)return null;if(be()){const r=e.find(e=>e.name===be());if(r)return r}return e[0]}),Ae={...u.obj,inner_path:void 0,archive:void 0},qe=u.raw_url,Ee=e=>{E(()=>{if(""===e)g.setObj(Ae),g.setRawUrl(qe),fe("");else{const r=ze().find(r=>r.name===e);if(r){const t=M(r);g.setObj(r),g.setRawUrl(t),fe(e)}}})};return d(()=>{g.setObj(Ae),g.setRawUrl(qe)}),s(()=>{me(),je("")}),h(C,{spacing:"$2",w:"$full",get children(){return[h(p,{pl:"$2",pr:"$2",w:"$full",get children(){return[h(w,{get children(){return h(m,{get currentPage(){return f(()=>0===ce().length)()&&!me()},"on:click":()=>{oe([]),Ee("")},children:"."})}}),h(b,{get each(){return ce()},children:(e,r)=>h(w,{get children(){return[h(j,{}),h(m,{get currentPage(){return f(()=>ce().length===r()+1)()&&!me()},"on:click":()=>{oe(ce().slice(0,r()+1)),Ee("")},children:e})]}})}),h(y,{get when(){return me()},get children(){return h(w,{get children(){return[h(j,{}),h(m,{currentPage:!0,get children(){return me()}})]}})}})]}}),h(_,{get children(){return[h(k,{get when(){return""!==D()},get children(){return h($,{get msg(){return D()},disableColor:!0})}}),h(k,{get when(){return ee()},get children(){return h(ae,{get title(){return e("home.toolbar.archive.input_password")},password:()=>N,setPassword:e=>N=e,enterCallback:()=>Ce(),get children(){return h(y,{get when(){return W()},get children(){return h(x,{color:"$danger9",get children(){return e("home.toolbar.archive.incorrect_password")}})}})}})}}),h(k,{get when(){return f(()=>!ee())()&&""===D()},get children(){return h(y,{get when(){return me()},get fallback(){return h(I,{get loading(){return K()},get children(){return h(C,{class:"list",w:"$full",spacing:"$1",get children(){return[h(X,{sortCallback:Pe,disableCheckbox:!0}),h(b,{get each(){return Oe()},children:(e,t)=>{const n=Se(e);let l=e.is_dir?void 0:M(n),a=(i=e.name,(ce().length>0?"/"+ce().join("/"):"")+"/"+i);var i;return h(r,{obj:e,get index(){return t()},jumpCallback:()=>oe(ce().concat(e.name)),innerPath:a,url:l,pass:N,onFileClick:()=>Ee(e.name)})}}),h(de,{})]}})}})},get children(){return h(y,{get when(){return me()},get fallback(){return h(P,{})},get children(){return h(C,{w:"$full",spacing:"$2",alignItems:"center",get children(){return[h(y,{get when(){return Ie()},get children(){return h(O,{get fallback(){return h(P,{})},get children(){return h(S,{get component(){return Ie()?.component},get images(){return ze().filter(e=>e.type===Z.IMAGE)},navigate:e=>{Ee(e)}})}})}}),h(z,{w:"$full",justifyContent:"center",spacing:"$2",p:"$2",get children(){return[h(y,{get when(){return Fe().length>1},get children(){return h(F,{get value(){return Ie()?.name||""},onChange:e=>je(String(e)),get options(){return Fe().map(e=>({value:e.name,label:e.name}))}})}}),h(le,{get file(){return{name:me(),raw_url:u.raw_url,d_url:u.raw_url}}})]}})]}})}})}})}})]}}),h(y,{get when(){return""!==te()},get children(){return[h(A,{}),h(x,{w:"$full",pl:"$1",pr:"$1",get children(){return te()}})]}})]}})})}}});

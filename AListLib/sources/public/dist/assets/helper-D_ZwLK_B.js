import{cI as $,bc as X,a_ as Y,a$ as L,bg as F,a8 as A,C as J,q as M,dT as z,N as O,b0 as U,dN as C,k as G}from"./index-BeFrtC4h.js";import{b as Q}from"./style-Mplh4sB8.js";/*! @viselect/vanilla v3.9.0 MIT | https://github.com/Simonwep/selection/tree/master/packages/vanilla */class V{constructor(){this._listeners=new Map,this.on=this.addEventListener,this.off=this.removeEventListener,this.emit=this.dispatchEvent}addEventListener(e,t){var i;const s=(i=this._listeners.get(e))!=null?i:new Set;return this._listeners.set(e,s),s.add(t),this}removeEventListener(e,t){var s;return(s=this._listeners.get(e))==null||s.delete(t),this}dispatchEvent(e,...t){var i;let s=!0;for(const o of(i=this._listeners.get(e))!=null?i:[])s=o(...t)!==!1&&s;return s}unbindAllListeners(){this._listeners.clear()}}const B=(n,e="px")=>typeof n=="number"?n+e:n,b=({style:n},e,t)=>{if(typeof e=="object")for(const[s,i]of Object.entries(e))i!==void 0&&(n[s]=B(i));else t!==void 0&&(n[e]=B(t))},R=(n=0,e=0,t=0,s=0)=>{const i={x:n,y:e,width:t,height:s,top:e,left:n,right:n+t,bottom:e+s};return{...i,toJSON:()=>JSON.stringify(i)}},Z=n=>{let e,t=-1,s=!1;return{next:(...i)=>{e=i,s||(s=!0,t=requestAnimationFrame(()=>{n(...e),s=!1}))},cancel:()=>{cancelAnimationFrame(t),s=!1}}},D=(n,e,t="touch")=>{switch(t){case"center":{const s=e.left+e.width/2,i=e.top+e.height/2;return s>=n.left&&s<=n.right&&i>=n.top&&i<=n.bottom}case"cover":return e.left>=n.left&&e.top>=n.top&&e.right<=n.right&&e.bottom<=n.bottom;case"touch":return n.right>=e.left&&n.left<=e.right&&n.bottom>=e.top&&n.top<=e.bottom}},ee=()=>matchMedia("(hover: none), (pointer: coarse)").matches,te=()=>"safari"in window,k=n=>Array.isArray(n)?n:[n],q=n=>(e,t,s,i={})=>{(e instanceof HTMLCollection||e instanceof NodeList)&&(e=Array.from(e)),t=k(t),e=k(e);for(const o of e)if(o)for(const l of t)o[n](l,s,{capture:!1,...i})},y=q("addEventListener"),v=q("removeEventListener"),w=n=>{var o;var e;const{clientX:t,clientY:s,target:i}=(o=(e=n.touches)==null?void 0:e[0])!=null?o:n;return{x:t,y:s,target:i}},E=(n,e=document)=>k(n).map(t=>typeof t=="string"?Array.from(e.querySelectorAll(t)):t instanceof Element?t:null).flat().filter(Boolean),se=(n,e)=>e.some(t=>typeof t=="number"?n.button===t:typeof t=="object"?t.button!==n.button?!1:t.modifiers.every(s=>{switch(s){case"alt":return n.altKey;case"ctrl":return n.ctrlKey||n.metaKey;case"shift":return n.shiftKey}}):!1),{abs:S,max:j,min:N,ceil:P}=Math,K=(n=[])=>({stored:n,selected:[],touched:[],changed:{added:[],removed:[]}}),W=class extends V{constructor(e){var t,s,i,o,l;super(),this._selection=K(),this._targetBoundaryScrolled=!0,this._selectables=[],this._areaLocation={y1:0,x2:0,y2:0,x1:0},this._areaRect=R(),this._singleClick=!0,this._scrollAvailable=!0,this._scrollingActive=!1,this._scrollSpeed={x:0,y:0},this._scrollDelta={x:0,y:0},this._lastMousePosition={x:0,y:0},this.enable=this._toggleStartEvents,this.disable=this._toggleStartEvents.bind(this,!1),this._options={selectionAreaClass:"selection-area",selectionContainerClass:void 0,selectables:[],document:window.document,startAreas:["html"],boundaries:["html"],container:"body",...e,behaviour:{overlap:"invert",intersect:"touch",triggers:[0],...e.behaviour,startThreshold:(t=e.behaviour)!=null&&t.startThreshold?typeof e.behaviour.startThreshold=="number"?e.behaviour.startThreshold:{x:10,y:10,...e.behaviour.startThreshold}:{x:10,y:10},scrolling:{speedDivider:10,manualSpeed:750,...(s=e.behaviour)==null?void 0:s.scrolling,startScrollMargins:{x:0,y:0,...(o=(i=e.behaviour)==null?void 0:i.scrolling)==null?void 0:o.startScrollMargins}}},features:{range:!0,touch:!0,deselectOnBlur:!1,...e.features,singleTap:{allow:!0,intersect:"native",...(l=e.features)==null?void 0:l.singleTap}}};for(const h of Object.getOwnPropertyNames(Object.getPrototypeOf(this)))typeof this[h]=="function"&&(this[h]=this[h].bind(this));const{document:r,selectionAreaClass:d,selectionContainerClass:c}=this._options;this._area=r.createElement("div"),this._clippingElement=r.createElement("div"),this._clippingElement.appendChild(this._area),this._area.classList.add(d),c&&this._clippingElement.classList.add(c),b(this._area,{willChange:"top, left, bottom, right, width, height",top:0,left:0,position:"fixed"}),b(this._clippingElement,{overflow:"hidden",position:"fixed",transform:"translate3d(0, 0, 0)",pointerEvents:"none",zIndex:"1"}),this._frame=Z(h=>{this._recalculateSelectionAreaRect(),this._updateElementSelection(),this._emitEvent("move",h),this._redrawSelectionArea()}),this.enable()}_toggleStartEvents(e=!0){const{document:t,features:s}=this._options,i=e?y:v;i(t,"mousedown",this._onTapStart),s.touch&&i(t,"touchstart",this._onTapStart,{passive:!1})}_onTapStart(e,t=!1){var x;const{x:s,y:i,target:o}=w(e),{document:l,startAreas:r,boundaries:d,features:c,behaviour:h}=this._options,a=o.getBoundingClientRect();if(e instanceof MouseEvent&&!se(e,h.triggers))return;const p=E(r,l),f=E(d,l);this._targetElement=f.find(g=>D(g.getBoundingClientRect(),a));const m=e.composedPath(),_=p.find(g=>m.includes(g));if(this._targetBoundary=f.find(g=>m.includes(g)),!this._targetElement||!_||!this._targetBoundary||!t&&this._emitEvent("beforestart",e)===!1)return;this._areaLocation={x1:s,y1:i,x2:0,y2:0};const u=(x=l.scrollingElement)!=null?x:l.body;this._scrollDelta={x:u.scrollLeft,y:u.scrollTop},this._singleClick=!0,this.clearSelection(!1,!0),y(l,["touchmove","mousemove"],this._delayedTapMove,{passive:!1}),y(l,["mouseup","touchcancel","touchend"],this._onTapStop),y(l,"scroll",this._onScroll),c.deselectOnBlur&&(this._targetBoundaryScrolled=!1,y(this._targetBoundary,"scroll",this._onStartAreaScroll))}_onSingleTap(e){const{singleTap:{intersect:t},range:s}=this._options.features,i=w(e);let o;if(t==="native")o=i.target;else if(t==="touch"){this.resolveSelectables();const{x:r,y:d}=i;o=this._selectables.find(c=>{const{right:h,left:a,top:p,bottom:f}=c.getBoundingClientRect();return r<h&&r>a&&d<f&&d>p})}if(!o)return;for(this.resolveSelectables();!this._selectables.includes(o);)if(o.parentElement)o=o.parentElement;else{this._targetBoundaryScrolled||this.clearSelection();return}const{stored:l}=this._selection;if(this._emitEvent("start",e),e.shiftKey&&s&&this._latestElement){const r=this._latestElement,[d,c]=r.compareDocumentPosition(o)&4?[o,r]:[r,o],h=[...this._selectables.filter(a=>a.compareDocumentPosition(d)&4&&a.compareDocumentPosition(c)&2),d,c];this.select(h),this._latestElement=r}else l.includes(o)&&(l.length===1||e.ctrlKey||l.every(r=>this._selection.stored.includes(r)))?this.deselect(o):(this.select(o),this._latestElement=o)}_delayedTapMove(e){const{container:t,document:s,behaviour:{startThreshold:i}}=this._options,{x1:o,y1:l}=this._areaLocation,{x:r,y:d}=w(e);if(typeof i=="number"&&S(r+d-(o+l))>=i||typeof i=="object"&&S(r-o)>=i.x||S(d-l)>=i.y){if(v(s,["mousemove","touchmove"],this._delayedTapMove,{passive:!1}),this._emitEvent("beforedrag",e)===!1){v(s,["mouseup","touchcancel","touchend"],this._onTapStop);return}y(s,["mousemove","touchmove"],this._onTapMove,{passive:!1}),b(this._area,"display","block"),E(t,s)[0].appendChild(this._clippingElement),this.resolveSelectables(),this._singleClick=!1,this._targetRect=this._targetElement.getBoundingClientRect(),this._scrollAvailable=this._targetElement.scrollHeight!==this._targetElement.clientHeight||this._targetElement.scrollWidth!==this._targetElement.clientWidth,this._scrollAvailable&&(y(this._targetElement,"wheel",this._wheelScroll,{passive:!1}),y(this._options.document,"keydown",this._keyboardScroll,{passive:!1}),this._selectables=this._selectables.filter(c=>this._targetElement.contains(c))),this._setupSelectionArea(),this._emitEvent("start",e),this._onTapMove(e)}this._handleMoveEvent(e)}_setupSelectionArea(){const{_clippingElement:e,_targetElement:t,_area:s}=this,i=this._targetRect=t.getBoundingClientRect();this._scrollAvailable?(b(e,{top:i.top,left:i.left,width:i.width,height:i.height}),b(s,{marginTop:-i.top,marginLeft:-i.left})):(b(e,{top:0,left:0,width:"100%",height:"100%"}),b(s,{marginTop:0,marginLeft:0}))}_onTapMove(e){const{_scrollSpeed:t,_areaLocation:s,_options:i,_frame:o}=this,{speedDivider:l}=i.behaviour.scrolling,r=this._targetElement,{x:d,y:c}=w(e);if(s.x2=d,s.y2=c,this._lastMousePosition.x=d,this._lastMousePosition.y=c,this._scrollAvailable&&!this._scrollingActive&&(t.y||t.x)){this._scrollingActive=!0;const h=()=>{if(!t.x&&!t.y){this._scrollingActive=!1;return}const{scrollTop:a,scrollLeft:p}=r;t.y&&(r.scrollTop+=P(t.y/l),s.y1-=r.scrollTop-a),t.x&&(r.scrollLeft+=P(t.x/l),s.x1-=r.scrollLeft-p),o.next(e),requestAnimationFrame(h)};requestAnimationFrame(h)}else o.next(e);this._handleMoveEvent(e)}_handleMoveEvent(e){const{features:t}=this._options;(t.touch&&ee()||this._scrollAvailable&&te())&&e.preventDefault()}_onScroll(){var o;const{_scrollDelta:e,_options:{document:t}}=this,{scrollTop:s,scrollLeft:i}=(o=t.scrollingElement)!=null?o:t.body;this._areaLocation.x1+=e.x-i,this._areaLocation.y1+=e.y-s,e.x=i,e.y=s,this._setupSelectionArea(),this._frame.next(null)}_onStartAreaScroll(){this._targetBoundaryScrolled=!0,v(this._targetElement,"scroll",this._onStartAreaScroll)}_wheelScroll(e){const{manualSpeed:t}=this._options.behaviour.scrolling,s=e.deltaY?e.deltaY>0?1:-1:0,i=e.deltaX?e.deltaX>0?1:-1:0;this._scrollSpeed.y+=s*t,this._scrollSpeed.x+=i*t,this._onTapMove(e),e.preventDefault()}_keyboardScroll(e){const{manualSpeed:t}=this._options.behaviour.scrolling,s=e.key==="ArrowLeft"?-1:e.key==="ArrowRight"?1:0,i=e.key==="ArrowUp"?-1:e.key==="ArrowDown"?1:0;this._scrollSpeed.x+=Math.sign(s)*t,this._scrollSpeed.y+=Math.sign(i)*t,e.preventDefault(),this._onTapMove({clientX:this._lastMousePosition.x,clientY:this._lastMousePosition.y,preventDefault:()=>{}})}_recalculateSelectionAreaRect(){const{_scrollSpeed:e,_areaLocation:t,_targetElement:s,_options:i}=this,{scrollTop:o,scrollHeight:l,clientHeight:r,scrollLeft:d,scrollWidth:c,clientWidth:h}=s,a=this._targetRect,{x1:p,y1:f}=t;let{x2:m,y2:_}=t;const{behaviour:{scrolling:{startScrollMargins:u}}}=i;m<a.left+u.x?(e.x=d?-S(a.left-m+u.x):0,m=m<a.left?a.left:m):m>a.right-u.x?(e.x=c-d-h?S(a.left+a.width-m-u.x):0,m=m>a.right?a.right:m):e.x=0,_<a.top+u.y?(e.y=o?-S(a.top-_+u.y):0,_=_<a.top?a.top:_):_>a.bottom-u.y?(e.y=l-o-r?S(a.top+a.height-_-u.y):0,_=_>a.bottom?a.bottom:_):e.y=0;const x=N(p,m),g=N(f,_),H=j(p,m),I=j(f,_);this._areaRect=R(x,g,H-x,I-g)}_redrawSelectionArea(){const{x:e,y:t,width:s,height:i}=this._areaRect,{style:o}=this._area;o.left="".concat(e,"px"),o.top="".concat(t,"px"),o.width="".concat(s,"px"),o.height="".concat(i,"px")}_onTapStop(e,t){var s;const{document:i,features:o}=this._options,{_singleClick:l}=this;v(this._targetElement,"scroll",this._onStartAreaScroll),v(i,["mousemove","touchmove"],this._delayedTapMove),v(i,["touchmove","mousemove"],this._onTapMove),v(i,["mouseup","touchcancel","touchend"],this._onTapStop),v(i,"scroll",this._onScroll),this._keepSelection(),e&&l&&o.singleTap.allow?this._onSingleTap(e):!l&&!t&&(this._updateElementSelection(),this._emitEvent("stop",e)),this._scrollSpeed.x=0,this._scrollSpeed.y=0,v(this._targetElement,"wheel",this._wheelScroll,{passive:!0}),v(this._options.document,"keydown",this._keyboardScroll,{passive:!0}),this._clippingElement.remove(),(s=this._frame)==null||s.cancel(),b(this._area,"display","none")}_updateElementSelection(){const{_selectables:e,_options:t,_selection:s,_areaRect:i}=this,{stored:o,selected:l,touched:r}=s,{intersect:d,overlap:c}=t.behaviour,h=c==="invert",a=[],p=[],f=[];for(let _=0;_<e.length;_++){const u=e[_];if(D(i,u.getBoundingClientRect(),d)){if(l.includes(u))o.includes(u)&&!r.includes(u)&&r.push(u);else if(h&&o.includes(u)){f.push(u);continue}else p.push(u);a.push(u)}}h&&p.push(...o.filter(_=>!l.includes(_)));const m=c==="keep";for(let _=0;_<l.length;_++){const u=l[_];!a.includes(u)&&!(m&&o.includes(u))&&f.push(u)}s.selected=a,s.changed={added:p,removed:f},this._latestElement=void 0}_emitEvent(e,t){return this.emit(e,{event:t,store:this._selection,selection:this})}_keepSelection(){const{_options:e,_selection:t}=this,{selected:s,changed:i,touched:o,stored:l}=t,r=s.filter(d=>!l.includes(d));switch(e.behaviour.overlap){case"drop":{t.stored=[...r,...l.filter(d=>!o.includes(d))];break}case"invert":{t.stored=[...r,...l.filter(d=>!i.removed.includes(d))];break}case"keep":{t.stored=[...l,...s.filter(d=>!l.includes(d))];break}}}trigger(e,t=!0){this._onTapStart(e,t)}resolveSelectables(){this._selectables=E(this._options.selectables,this._options.document)}clearSelection(e=!0,t=!1){const{selected:s,stored:i,changed:o}=this._selection;o.added=[],o.removed.push(...s,...e?i:[]),t||(this._emitEvent("move",null),this._emitEvent("stop",null)),this._selection=K(e?[]:i)}getSelection(){return this._selection.stored}getSelectionArea(){return this._area}getSelectables(){return this._selectables}setAreaLocation(e){Object.assign(this._areaLocation,e),this._redrawSelectionArea()}getAreaLocation(){return this._areaLocation}cancel(e=!1){this._onTapStop(null,!e)}destroy(){this.cancel(),this.disable(),this._clippingElement.remove(),super.unbindAllListeners()}select(e,t=!1){const{changed:s,selected:i,stored:o}=this._selection,l=E(e,this._options.document).filter(r=>!i.includes(r)&&!o.includes(r));return o.push(...l),i.push(...l),s.added.push(...l),s.removed=[],this._latestElement=void 0,t||(this._emitEvent("move",null),this._emitEvent("stop",null)),l}deselect(e,t=!1){const{selected:s,stored:i,changed:o}=this._selection,l=E(e,this._options.document).filter(r=>s.includes(r)||i.includes(r));this._selection.stored=i.filter(r=>!l.includes(r)),this._selection.selected=s.filter(r=>!l.includes(r)),this._selection.changed.added=[],this._selection.changed.removed.push(...l.filter(r=>!o.removed.includes(r))),this._latestElement=void 0,t||(this._emitEvent("move",null),this._emitEvent("stop",null))}};W.version="3.9.0";let ie=W,T=null;function re(){const n=()=>!z&&Y(),e=()=>n()&&M.open_item_on_checkbox==="dblclick",t=()=>n()&&M.open_item_on_checkbox==="disable_while_checked"&&L(),s=()=>{T=G()},i=()=>{if(T===null)return!1;for(let c=0;c<A.objs.length;++c)C(c,T.indexOf(A.objs[c])>=0);return!0},o=()=>{T=null},l=()=>{J(()=>{if(!n()){const h=document.querySelector(".viselect-container");h==null||h.addEventListener("mousedown",s),O(()=>h==null?void 0:h.removeEventListener("mousedown",s));return}const c=new ie({selectionAreaClass:"viselect-selection-area",startAreas:[".viselect-container"],boundaries:[".viselect-container"],selectables:[".viselect-item"]});c.on("beforestart",()=>{s(),c.clearSelection(!0,!0),c.select(".viselect-item.selected",!0)}),c.on("start",({event:h})=>{const a=h;a.type==="mousemove"&&o(),!a.shiftKey&&!a.ctrlKey&&!a.metaKey&&(U(!1),c.clearSelection(!0))}),c.on("move",({store:{changed:{added:h,removed:a}}})=>{for(const p of h)C(Number(p.getAttribute("data-index")),!0);for(const p of a)C(Number(p.getAttribute("data-index")),!1)}),O(()=>c.destroy())})},{show:r}=Q({id:1});return{isMouseSupported:n,openWithDoubleClick:e,toggleWithClick:t,restoreSelectionCache:i,registerSelectContainer:l,captureContentMenu:c=>{if(c.preventDefault(),L()&&!F()){const a=c.target.closest(".viselect-item"),p=Number(a==null?void 0:a.getAttribute("data-index"));if(Number.isNaN(p)||!!!A.objs[p].selected)return;c.stopPropagation(),r(c,{props:A.obj})}}}}const ae=$(X,{baseStyle:{_before:{content:"",pos:"absolute",top:-10,right:-2,bottom:-10,left:-10}}});export{ae as I,re as u};

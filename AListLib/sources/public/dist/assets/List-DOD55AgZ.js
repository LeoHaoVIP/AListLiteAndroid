import{bW as T,R as W,k as y,E as t,ay as j,S as h,dW as f,b0 as I,aO as F,aS as P,aG as G,ai as o,r as M,cG as H,cH as U,dC as V,as as J,cF as N,cR as X,bV as R,a1 as S,ad as w,ax as Y,C as k,D as _,b2 as q,dX as Z,dY as Q,dZ as $,U as b,q as p,aw as ee,d_ as C,V as te,a6 as re,d$ as ne,aj as ie}from"./index-BFcje_PK.js";import{b as ae}from"./style-C-fe3_ER.js";import{n as se,t as O,u as le,s as oe}from"./storage-BWbNxF5o.js";import{M as ce}from"./index-CujSWyj5.js";import{O as A,g as ue}from"./icon-GBF7AwS-.js";import{I as z,u as D}from"./helper-BbREDs7J.js";const n=[{name:"name",textAlign:"left",w:{"@initial":"76%","@md":"50%"}},{name:"size",textAlign:"right",w:{"@initial":"24%","@md":"17%"}},{name:"modified",textAlign:"right",w:{"@initial":0,"@md":"33%"}}],de=e=>{const{isHide:s}=T();if(s(e.obj))return null;const{setPathAs:g}=W(),{show:c}=ae({id:1}),{pushHref:m,to:u}=y(),{openWithDoubleClick:l,toggleWithClick:d,restoreSelectionCache:a}=D(),i=()=>M.list_item_filename_overflow;return t(Y.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},style:{width:"100%"},get children(){return t(j,{get classList(){return{selected:!!e.obj.selected}},class:"list-item viselect-item",get"data-index"(){return e.index},w:"$full",p:"$2",rounded:"$lg",transition:"all 0.3s",get _hover(){return{transform:"scale(1.01)",bgColor:S()}},as:ce,get href(){return e.obj.name},get cursor(){return l()||d()?"default":"pointer"},get bgColor(){return w(()=>!!e.obj.selected)()?S():void 0},"on:dblclick":()=>{l()&&(f(e.index,!0,!0),u(m(e.obj.name)))},"on:click":r=>{if(r.preventDefault(),!l()&&!(r.ctrlKey||r.metaKey||r.shiftKey)&&a()){if(d())return f(e.index,!e.obj.selected);u(m(e.obj.name))}},onMouseEnter:()=>{g(e.obj.name,e.obj.is_dir,!0)},onContextMenu:r=>{R(()=>{f(e.index,!0,!0)}),c(r,{props:e.obj})},get children(){return[t(j,{class:"name-box",spacing:"$1",get w(){return n[0].w},get children(){return[t(h,{get when(){return I()},get children(){return t(z,{"on:mousedown":r=>{r.stopPropagation()},"on:click":r=>{r.stopPropagation()},get checked(){return e.obj.selected},onChange:r=>{f(e.index,r.target.checked)}})}}),t(F,{class:"icon",boxSize:"$6",get color(){return G()},get as(){return ue(e.obj)},mr:"$1",get cursor(){return e.obj.type!==A.IMAGE?"inherit":"pointer"},"on:click":r=>{e.obj.type===A.IMAGE&&(r.ctrlKey||r.metaKey||r.shiftKey||a()&&(P.emit("gallery",e.obj.name),r.preventDefault(),r.stopPropagation()))}}),t(o,{class:"name",get css(){return{wordBreak:"break-all",whiteSpace:i()==="multi_line"?"unset":"nowrap","overflow-x":i()==="scrollable"?"auto":"hidden",textOverflow:i()==="ellipsis"?"ellipsis":"unset","scrollbar-width":"none","&::-webkit-scrollbar":{display:"none"}}},get title(){return e.obj.name},get children(){return e.obj.name}})]}}),t(h,{get fallback(){return t(o,{class:"size",get w(){return n[1].w},get textAlign(){return n[1].textAlign},get children(){return N(e.obj.size)}})},get when(){return oe(e.obj.mount_details)},get children(){return t(h,{get fallback(){return t(o,{class:"size",get w(){return n[1].w},get textAlign(){return n[1].textAlign},get children(){return O(e.obj.mount_details)}})},get when(){return!J("show_disk_usage_in_plain_text")},get children(){return t(H,{get w(){return n[1].w},class:"disk-usage-percentage",trackColor:"$info3",rounded:"$full",size:"md",get value(){return le(e.obj.mount_details)},get children(){return[t(U,{get color(){return se(e.obj.mount_details)?"$danger6":"$info6"},rounded:"$md"}),t(V,{class:"disk-usage-text",get children(){return O(e.obj.mount_details)}})]}})}})}}),t(o,{class:"modified",display:{"@initial":"none","@md":"inline"},get w(){return n[2].w},get textAlign(){return n[2].textAlign},get children(){return X(e.obj.modified)}})]}})}})},L="dir_sort_";function B(e,s){try{localStorage.setItem("".concat(L).concat(e),JSON.stringify(s))}catch(g){console.warn("failed to save sort config:",g)}}function E(e){try{const s=localStorage.getItem("".concat(L).concat(e));return s?JSON.parse(s):null}catch(s){return console.warn("failed to read sort config:",s),null}}const K=e=>{var a;const s=p(),{pathname:g}=y(),[c,m]=k(e.initialOrder),[u,l]=k((a=e.initialReverse)!=null?a:!1);_(()=>{var i;e.initialOrder!==void 0&&(m(e.initialOrder),l((i=e.initialReverse)!=null?i:!1))}),_(()=>{c()&&(B(g(),{orderBy:c(),reverse:u()}),e.sortCallback(c(),u()))});const d=i=>({fontWeight:"bold",fontSize:"$sm",color:"$neutral11",textAlign:i.textAlign,cursor:"pointer",onClick:()=>{i.name===c()?l(!u()):R(()=>{m(i.name),l(!1)})}});return t(j,{class:"title",w:"$full",p:"$2",get children(){return[t(j,{get w(){return n[0].w},spacing:"$1",get children(){return[t(h,{get when(){return w(()=>!e.disableCheckbox)()&&I()},get children(){return t(z,{get checked(){return Q()},get indeterminate(){return Z()},onChange:i=>{q(i.target.checked)}})}}),w(()=>w(()=>!!$())()?t(o,b(()=>d(n[0]),{get children(){return $()}})):t(o,b(()=>d(n[0]),{get children(){return s("home.obj.".concat(n[0].name))}})))]}}),t(o,b({get w(){return n[1].w}},()=>d(n[1]),{get children(){return s("home.obj.".concat(n[1].name))}})),t(o,b({get w(){return n[2].w}},()=>d(n[2]),{display:{"@initial":"none","@md":"inline"},get children(){return s("home.obj.".concat(n[2].name))}}))]}})},ge=()=>{const{pathname:e}=y(),[s,g]=k(),[c,m]=k(!1),{registerSelectContainer:u,captureContentMenu:l}=D();return u(),ee(()=>{const a=E(e());a&&(g(a.orderBy),m(a.reverse),C(a.orderBy,a.reverse))}),t(ie,{onDragOver:a=>{var r,v;const i=Array.from((v=(r=a.dataTransfer)==null?void 0:r.items)!=null?v:[]);for(let x=0;x<i.length;x++)if(i[x].kind==="file"){P.emit("tool","upload"),a.preventDefault();break}},"oncapture:contextmenu":l,class:"list viselect-container",w:"$full",spacing:"$1",get children(){return[t(K,{sortCallback:C,get initialOrder(){return s()},get initialReverse(){return c()}}),t(te,{get each(){return re.objs},children:(a,i)=>t(de,{obj:a,get index(){return i()}})}),t(h,{get when(){return M.show_count_msg==="visible"},get children(){return t(o,{size:"sm",color:"$neutral11",get children(){return ne()}})}})]}})},xe=Object.freeze(Object.defineProperty({__proto__:null,ListTitle:K,default:ge,loadSortState:E,saveSortState:B},Symbol.toStringTag,{value:"Module"}));export{K as L,xe as a,n as c};

System.register(["./index-legacy-C7GeLJzS.js","./index-legacy-B3HW6xxC.js"],function(e,t){"use strict";var r,n,i,o,a,c,l,s,d,u,h,p,g,w,f,m,v,y,x,b,j;return{setters:[e=>{r=e.C,n=e.aw,i=e.P,o=e.E,a=e.ap,c=e.aX,l=e.aC,s=e.ad,d=e.q,u=e.az,h=e.a$,p=e.S,g=e.ae,w=e.ac,f=e.cq,m=e.ef,v=e.eg,y=e.cZ,x=e.a6},e=>{b=e.V,j=e.a}],execute:function(){var t=u("<div style=width:100%;height:100%;overflow:auto;position:relative;background:#f5f5f5><div id=docx-container style=width:100%;height:100%;padding:20px>");e("default",()=>{const e=d(),[u,k]=r(!0),[E,F]=r(!1),[C,z]=r(!1);let L,P;const $=(e,t)=>new Promise((r,n)=>{if(document.getElementById(t))return void r();const i=document.createElement("script");i.src=e,i.id=t,i.type="text/javascript",i.onload=()=>r(),i.onerror=()=>n(new w(`Failed to load script: ${e}`)),document.head.appendChild(i)}),_=()=>{L&&(document.fullscreenElement?document.exitFullscreen().then(()=>{z(!1)}):L.requestFullscreen().then(()=>{z(!0)}))},q=()=>{document.fullscreenElement||z(!1)};return n(()=>{(async()=>{try{if(k(!0),F(!1),await $("https://unpkg.com/jszip/dist/jszip.min.js","jszip-script"),await $("https://res.oplist.org.cn/docxjs/dist/docx-preview.min.js","docx-preview-script"),!window.docx)throw new w("docx-preview library not loaded");const e=x.raw_url,t=await fetch(e);if(!t.ok)throw new w("Failed to fetch document file");const r=await t.blob();P&&(await window.docx.renderAsync(r,P,void 0,{className:"docx-preview-container",inWrapper:!0,ignoreWidth:!1,ignoreHeight:!1,ignoreFonts:!1,breakPages:!0,ignoreLastRenderedPageBreak:!0,experimental:!1,trimXmlDeclaration:!0,useBase64URL:!1,useMathMLPolyfill:!1,renderChanges:!1,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0}),k(!1))}catch(e){console.error("DOCX初始化失败:",e),F(!0),k(!1)}})(),document.addEventListener("fullscreenchange",q)}),i(()=>{document.removeEventListener("fullscreenchange",q)}),o(y,{w:"$full",h:"70vh",pos:"relative",get children(){return[o(a,{pos:"absolute",top:"$2",right:"$2",zIndex:"10",opacity:"0.7",transition:"opacity 0.2s",_hover:{opacity:"1"},get children(){return o(c,{withArrow:!0,get label(){return s(()=>!!C())()?e("home.preview.exit_fullscreen"):e("home.preview.fullscreen")},get children(){return o(l,{size:"sm",colorScheme:"neutral","aria-label":"Toggle Fullscreen",get icon(){return s(()=>!!C())()?o(b,{}):o(j,{})},onClick:_})}})}}),(r=t(),n=r.firstChild,"function"==typeof L?v(L,r):L=r,"function"==typeof P?v(P,n):P=n,h(r,o(p,{get when(){return u()},get children(){return o(g,{})}}),null),h(r,o(p,{get when(){return E()},get children(){return o(w,{get msg(){return e("preview.failed_load_doc")},h:"70vh"})}}),null),f(e=>m(n,"display",u()||E()?"none":"block")),r)];var r,n}})})}}});

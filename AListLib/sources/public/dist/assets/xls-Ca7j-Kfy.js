import{C as g,aw as P,E as t,ap as N,S as v,ay as H,V as _,L as M,ad as x,aX as U,aC as X,q as Z,az as S,a$ as f,cq as G,ef as y,ae as K,ac as b,eg as O,cZ as Q,a6 as Y}from"./index-BFcje_PK.js";import{V as ee,a as te}from"./index-LpOJCJG0.js";var re=S('<div style=padding:20px;overflow:auto><table style="border-collapse:collapse;width:100%;background-color:white;box-shadow:0 2px 8px rgba(0,0,0,0.1)"><tbody>'),ne=S("<div style=width:100%;height:100%;overflow:auto;position:relative;background:#ffffff;padding-top:50px>"),oe=S("<tr>"),ae=S('<td style="border:1px solid #ddd;padding:8px 12px;white-space:pre-wrap;word-break:break-word;min-width:100px">');const ie=()=>{const E=Z(),[C,$]=g(!0),[F,j]=g(!1),[B,I]=g(!1),[p,R]=g([]),[V,T]=g(0);let w;const W=()=>new Promise((r,o)=>{if(window.ExcelJS){r();return}const l=document.getElementById("exceljs-script");if(l){l.addEventListener("load",()=>r()),l.addEventListener("error",()=>o(new b("Failed to load ExcelJS library")));return}const a=document.createElement("script");a.src="https://res.oplist.org.cn/exceljs/exceljs.min.js",a.id="exceljs-script",a.async=!0,a.onload=()=>r(),a.onerror=()=>o(new b("Failed to load ExcelJS library")),document.head.appendChild(a)}),A=async()=>{try{$(!0),j(!1),await W();const r=Y.raw_url,o=await fetch(r);if(!o.ok)throw new b("Failed to fetch Excel file");const l=await o.arrayBuffer(),a=new window.ExcelJS.Workbook;await a.xlsx.load(l);const m=[];a.worksheets.forEach(c=>{const h=[];c.eachRow((s,u)=>{const n=[];s.eachCell({includeEmpty:!0},(e,k)=>{let d="";e.value!==null&&e.value!==void 0&&(typeof e.value=="object"&&"text"in e.value?d=e.value.text:typeof e.value=="object"&&"result"in e.value?d=String(e.value.result):d=String(e.value));const i={};e.font&&(i.bold=e.font.bold,i.italic=e.font.italic),e.fill&&e.fill.fgColor&&(i.bgColor=e.fill.fgColor.argb),e.alignment&&(i.alignment=e.alignment.horizontal||"left"),n.push({value:d,style:i})}),h.push(n)}),m.push({name:c.name,rows:h})}),R(m),$(!1)}catch(r){console.error("Excel加载失败:",r),j(!0),$(!1)}},D=()=>{w&&(document.fullscreenElement?document.exitFullscreen().then(()=>{I(!1)}):w.requestFullscreen().then(()=>{I(!0)}))};return P(()=>{A()}),t(Q,{w:"$full",h:"70vh",pos:"relative",get children(){return[t(N,{pos:"absolute",top:"$2",left:"$2",right:"$2",zIndex:"10",display:"flex",justifyContent:"space-between",alignItems:"center",px:"$2",get children(){return[t(v,{get when(){return x(()=>!C()&&!F())()&&p().length>0},get children(){return t(H,{spacing:"$2",flexWrap:"wrap",get children(){return t(_,{get each(){return p()},children:(r,o)=>t(M,{size:"sm",get variant(){return V()===o()?"solid":"outline"},colorScheme:"primary",onClick:()=>T(o()),get children(){return r.name}})})}})}}),t(N,{opacity:"0.7",transition:"opacity 0.2s",_hover:{opacity:"1"},get children(){return t(U,{withArrow:!0,get label(){return x(()=>!!B())()?E("home.preview.exit_fullscreen"):E("home.preview.fullscreen")},get children(){return t(X,{size:"sm",colorScheme:"neutral","aria-label":"Toggle Fullscreen",get icon(){return x(()=>!!B())()?t(ee,{}):t(te,{})},onClick:D})}})}})]}}),(()=>{var r=ne(),o=w;return typeof o=="function"?O(o,r):w=r,f(r,t(v,{get when(){return x(()=>!C()&&!F())()&&p().length>0},get children(){var l=re(),a=l.firstChild,m=a.firstChild;return f(m,t(_,{get each(){var c;return((c=p()[V()])==null?void 0:c.rows)||[]},children:c=>(()=>{var h=oe();return f(h,t(_,{each:c,children:s=>(()=>{var u=ae();return f(u,()=>s.value),G(n=>{var z,J,L,q;var e=(z=s.style)!=null&&z.bold?"bold":"normal",k=(J=s.style)!=null&&J.italic?"italic":"normal",d=(L=s.style)!=null&&L.bgColor?"#".concat(s.style.bgColor.slice(2)):"transparent",i=((q=s.style)==null?void 0:q.alignment)||"left";return e!==n.e&&y(u,"font-weight",n.e=e),k!==n.t&&y(u,"font-style",n.t=k),d!==n.a&&y(u,"background-color",n.a=d),i!==n.o&&y(u,"text-align",n.o=i),n},{e:void 0,t:void 0,a:void 0,o:void 0}),u})()})),h})()})),l}}),null),f(r,t(v,{get when(){return C()},get children(){return t(K,{})}}),null),f(r,t(v,{get when(){return F()},get children(){return t(b,{get msg(){return E("preview.failed_load_excel")},h:"70vh"})}}),null),r})()]}})};export{ie as default};

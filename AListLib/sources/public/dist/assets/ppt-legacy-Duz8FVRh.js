System.register(["./index-legacy-D2rKgweC.js","./index-legacy-Bb37r2Qp.js"],function(e,t){"use strict";var r,n,i,s,l,o,a,d,c,u,p,h,m,w,y,f,v,g,j,x,$;return{setters:[e=>{r=e.B,n=e.av,i=e.O,s=e.D,l=e.ao,o=e.aW,a=e.aB,d=e.ac,c=e.o,u=e.ay,p=e.a_,h=e.S,m=e.ad,w=e.ab,y=e.cp,f=e.ee,v=e.ef,g=e.cY,j=e.a5},e=>{x=e.V,$=e.a}],execute:function(){var t=u("<div style=width:100%;height:100%;overflow:auto;position:relative;background:#f5f5f5><div id=ppt-result style=width:100%;height:100%>");e("default",()=>{const e=c(),[u,S]=r(!0),[E,k]=r(!1),[C,T]=r(!1);let b,P;const B=(e,t)=>new Promise((r,n)=>{if(document.getElementById(t))return void r();const i=document.createElement("script");i.src=e,i.id=t,i.type="text/javascript",i.onload=()=>r(),i.onerror=()=>n(new w(`Failed to load script: ${e}`)),document.head.appendChild(i)}),q=(e,t)=>new Promise((r,n)=>{if(document.getElementById(t))return void r();const i=document.createElement("link");i.rel="stylesheet",i.href=e,i.id=t,i.onload=()=>r(),i.onerror=()=>n(new w(`Failed to load CSS: ${e}`)),document.head.appendChild(i)}),F=()=>{b&&(document.fullscreenElement?document.exitFullscreen().then(()=>{T(!1),P&&P.querySelectorAll(".slide").forEach(e=>{e.style.width="",e.style.margin=""})}):b.requestFullscreen().then(()=>{T(!0),P&&P.querySelectorAll(".slide").forEach(e=>{e.style.width="99%",e.style.margin="0 auto"})}))},_=()=>{!document.fullscreenElement&&(T(!1),P)&&P.querySelectorAll(".slide").forEach(e=>{e.style.width="",e.style.margin=""})};return n(()=>{(async()=>{try{S(!0),k(!1);const e="https://res.oplist.org.cn/ppt.js";if(await Promise.all([q(`${e}/css/pptxjs.css`,"pptxjs-css"),q(`${e}/css/nv.d3.min.css`,"nv-d3-css")]),await B(`${e}/js/jquery-1.11.3.min.js`,"jquery-script"),await B("https://unpkg.com/jszip@2.6.1/dist/jszip.min.js","jszip-script"),await B(`${e}/js/filereader.js`,"filereader-script"),await B(`${e}/js/d3.min.js`,"d3-script"),await B(`${e}/js/nv.d3.min.js`,"nv-d3-script"),await B(`${e}/js/pptxjs.js`,"pptxjs-script"),await B(`${e}/js/divs2slides.js`,"divs2slides-script"),!window.$||!window.jQuery)throw new w("jQuery not loaded");P&&(window.$(P).pptxToHtml({pptxFileUrl:j.raw_url,slideMode:!1,keyBoardShortCut:!1,slideModeConfig:{first:1,nav:!1,navTxtColor:"white",navNextTxt:"&#8250;",navPrevTxt:"&#8249;",showPlayPauseBtn:!1,keyBoardShortCut:!1,showSlideNum:!1,showTotalSlideNum:!1,autoSlide:!1,randomAutoSlide:!1,loop:!1,background:"black",transition:"default",transitionTime:1}}),setTimeout(()=>{S(!1)},2e3))}catch(e){console.error("PPT初始化失败:",e),k(!0),S(!1)}})(),document.addEventListener("fullscreenchange",_)}),i(()=>{document.removeEventListener("fullscreenchange",_)}),s(g,{w:"$full",h:"70vh",pos:"relative",get children(){return[s(l,{pos:"absolute",top:"$2",right:"$2",zIndex:"10",opacity:"0.7",transition:"opacity 0.2s",_hover:{opacity:"1"},get children(){return s(o,{withArrow:!0,get label(){return d(()=>!!C())()?e("home.preview.exit_fullscreen"):e("home.preview.fullscreen")},get children(){return s(a,{size:"sm",colorScheme:"neutral","aria-label":"Toggle Fullscreen",get icon(){return d(()=>!!C())()?s(x,{}):s($,{})},onClick:F})}})}}),(r=t(),n=r.firstChild,"function"==typeof b?v(b,r):b=r,"function"==typeof P?v(P,n):P=n,p(r,s(h,{get when(){return u()},get children(){return s(m,{})}}),null),p(r,s(h,{get when(){return E()},get children(){return s(w,{get msg(){return e("preview.failed_load_ppt")},h:"70vh"})}}),null),y(e=>f(n,"display",u()||E()?"none":"block")),r)];var r,n}})})}}});

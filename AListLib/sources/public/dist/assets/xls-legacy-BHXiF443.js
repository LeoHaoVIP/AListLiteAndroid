System.register(["./index-legacy-C7GeLJzS.js","./index-legacy-B3HW6xxC.js"],function(e,t){"use strict";var r,l,n,o,a,i,c,s,d,u,h,g,p,f,w,v,x,y,m,b,C,E,k;return{setters:[e=>{r=e.C,l=e.aw,n=e.E,o=e.ap,a=e.S,i=e.ay,c=e.V,s=e.L,d=e.ad,u=e.aX,h=e.aC,g=e.q,p=e.az,f=e.a$,w=e.cq,v=e.ef,x=e.ae,y=e.ac,m=e.eg,b=e.cZ,C=e.a6},e=>{E=e.V,k=e.a}],execute:function(){var t=p('<div style=padding:20px;overflow:auto><table style="border-collapse:collapse;width:100%;background-color:white;box-shadow:0 2px 8px rgba(0,0,0,0.1)"><tbody>'),j=p("<div style=width:100%;height:100%;overflow:auto;position:relative;background:#ffffff;padding-top:50px>"),S=p("<tr>"),$=p('<td style="border:1px solid #ddd;padding:8px 12px;white-space:pre-wrap;word-break:break-word;min-width:100px">');e("default",()=>{const e=g(),[p,F]=r(!0),[z,_]=r(!1),[J,q]=r(!1),[I,L]=r([]),[B,V]=r(0);let W;const A=async()=>{try{F(!0),_(!1),await new Promise((e,t)=>{if(window.ExcelJS)return void e();const r=document.getElementById("exceljs-script");if(r)return r.addEventListener("load",()=>e()),void r.addEventListener("error",()=>t(new y("Failed to load ExcelJS library")));const l=document.createElement("script");l.src="https://res.oplist.org.cn/exceljs/exceljs.min.js",l.id="exceljs-script",l.async=!0,l.onload=()=>e(),l.onerror=()=>t(new y("Failed to load ExcelJS library")),document.head.appendChild(l)});const e=C.raw_url,t=await fetch(e);if(!t.ok)throw new y("Failed to fetch Excel file");const r=await t.arrayBuffer(),l=new window.ExcelJS.Workbook;await l.xlsx.load(r);const n=[];l.worksheets.forEach(e=>{const t=[];e.eachRow((e,r)=>{const l=[];e.eachCell({includeEmpty:!0},(e,t)=>{let r="";null!==e.value&&void 0!==e.value&&(r="object"==typeof e.value&&"text"in e.value?e.value.text:"object"==typeof e.value&&"result"in e.value?String(e.value.result):String(e.value));const n={};e.font&&(n.bold=e.font.bold,n.italic=e.font.italic),e.fill&&e.fill.fgColor&&(n.bgColor=e.fill.fgColor.argb),e.alignment&&(n.alignment=e.alignment.horizontal||"left"),l.push({value:r,style:n})}),t.push(l)}),n.push({name:e.name,rows:t})}),L(n),F(!1)}catch(e){console.error("Excel加载失败:",e),_(!0),F(!1)}},P=()=>{W&&(document.fullscreenElement?document.exitFullscreen().then(()=>{q(!1)}):W.requestFullscreen().then(()=>{q(!0)}))};return l(()=>{A()}),n(b,{w:"$full",h:"70vh",pos:"relative",get children(){return[n(o,{pos:"absolute",top:"$2",left:"$2",right:"$2",zIndex:"10",display:"flex",justifyContent:"space-between",alignItems:"center",px:"$2",get children(){return[n(a,{get when(){return d(()=>!(p()||z()))()&&I().length>0},get children(){return n(i,{spacing:"$2",flexWrap:"wrap",get children(){return n(c,{get each(){return I()},children:(e,t)=>n(s,{size:"sm",get variant(){return B()===t()?"solid":"outline"},colorScheme:"primary",onClick:()=>V(t()),get children(){return e.name}})})}})}}),n(o,{opacity:"0.7",transition:"opacity 0.2s",_hover:{opacity:"1"},get children(){return n(u,{withArrow:!0,get label(){return d(()=>!!J())()?e("home.preview.exit_fullscreen"):e("home.preview.fullscreen")},get children(){return n(h,{size:"sm",colorScheme:"neutral","aria-label":"Toggle Fullscreen",get icon(){return d(()=>!!J())()?n(E,{}):n(k,{})},onClick:P})}})}})]}}),(r=j(),"function"==typeof W?m(W,r):W=r,f(r,n(a,{get when(){return d(()=>!(p()||z()))()&&I().length>0},get children(){var e=t(),r=e.firstChild.firstChild;return f(r,n(c,{get each(){return I()[B()]?.rows||[]},children:e=>{return t=S(),f(t,n(c,{each:e,children:e=>{return t=$(),f(t,()=>e.value),w(r=>{var l=e.style?.bold?"bold":"normal",n=e.style?.italic?"italic":"normal",o=e.style?.bgColor?`#${e.style.bgColor.slice(2)}`:"transparent",a=e.style?.alignment||"left";return l!==r.e&&v(t,"font-weight",r.e=l),n!==r.t&&v(t,"font-style",r.t=n),o!==r.a&&v(t,"background-color",r.a=o),a!==r.o&&v(t,"text-align",r.o=a),r},{e:void 0,t:void 0,a:void 0,o:void 0}),t;var t}})),t;var t}})),e}}),null),f(r,n(a,{get when(){return p()},get children(){return n(x,{})}}),null),f(r,n(a,{get when(){return z()},get children(){return n(y,{get msg(){return e("preview.failed_load_excel")},h:"70vh"})}}),null),r)];var r}})})}}});

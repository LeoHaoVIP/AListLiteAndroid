System.register(["./index-legacy-C7GeLJzS.js","./index-legacy-BfhvY8g1.js"],function(e,r){"use strict";var t,n,o,l,a,u,c,g,i,d,s,h,p,f,w,b,C,m,$,y,v,k,x,S,F,I,O,z,P,_,E,H,j,T,V,M,R,D,G,K,W,A,B,L,N;return{setters:[e=>{t=e.a_,n=e.E,o=e.I,l=e.q,a=e.S,u=e.L,c=e.ay,g=e.M,i=e.F,d=e.bw,s=e.G,h=e.H,p=e.K,f=e.N,w=e.C,b=e.dK,C=e.ap,m=e.D,$=e.ad,y=e.bW,v=e.dL,k=e.bb,x=e.dM,S=e._,F=e.dN,I=e.al,O=e.aO,z=e.aG,P=e.dO,_=e.ai,E=e.o,H=e.a1,j=e.aj,T=e.V,V=e.A,M=e.bv,R=e.bk,D=e.aw,G=e.O,K=e.x,W=e.bd},e=>{A=e.o,B=e.E,L=e.G,N=e.H}],execute:function(){const r=b(),q=e("F",e=>{const[t,o]=w("/"),[l,a]=w(null);return e.handle?.({setPath:o,startCreateFolder:()=>{a(t())}}),n(C,{class:"folder-tree-box",w:"$full",overflowX:"auto",get children(){return n(r.Provider,{get value(){return{value:t,onChange:r=>{o(r),e.onChange(r)},autoOpen:e.autoOpen??!1,forceRoot:e.forceRoot??!1,showEmptyIcon:e.showEmptyIcon??!1,showHiddenFolder:e.showHiddenFolder??!0,creatingFolderPath:l,setCreatingFolderPath:a}},get children(){return n(X,{path:"/"})}})}})}),X=e=>{const{isHidePath:o}=y(),[l,u]=w(),{value:g,onChange:i,forceRoot:d,autoOpen:s,showEmptyIcon:h,showHiddenFolder:p,creatingFolderPath:f,setCreatingFolderPath:b}=v(r),[R,D]=k(()=>x(e.path,S(),d));let G=!1;const K=async(e=!1)=>{if(!e&&l()?.length)return;const r=await D();M(r,e=>{G=!0,u(e)},()=>{W()&&L()})},{isOpen:W,onToggle:L}=t(),N=()=>g()===e.path,q=F(e.path);return m(I(g,async e=>{s&&q(e)&&(W()||L(),G||K())})),m(()=>{f()===e.path&&(W()||L(),G||K())}),n(a,{get when(){return p||!(o(e.path)&&!q(g()))},get children(){return n(C,{get children(){return[n(c,{spacing:"$2",get children(){return[n(a,{get when(){return!R()},get fallback(){return n(P,{size:"sm",get color(){return z()}})},get children(){return n(a,{get when(){return!Boolean(h&&void 0!==l()&&!l()?.length)},get fallback(){return n(O,{get color(){return z()},as:B})},get children(){return n(O,{get color(){return z()},as:A,get transform(){return W()?"rotate(90deg)":"none"},transition:"transform 0.2s",cursor:"pointer",onClick:()=>{L(),W()&&K()}})}})}}),n(_,{css:{whiteSpace:"nowrap"},fontSize:"$md",cursor:"pointer",px:"$1",rounded:"$md",get bgColor(){return N()?"$info8":"transparent"},get _hover(){return{bgColor:N()?"$info8":H()}},onClick:()=>{i(e.path)},get children(){return $(()=>"/"===e.path)()?"root":E(e.path)}})]}}),n(a,{get when(){return W()},get children(){return n(j,{mt:"$1",pl:"$4",alignItems:"start",spacing:"$1",get children(){return[n(T,{get each(){return l()},children:r=>n(X,{get path(){return V(e.path,r.name)}})}),n(a,{get when(){return f()===e.path},get children(){return n(J,{get parentPath(){return e.path},onCancel:()=>b(null),onSuccess:e=>{b(null),i(e),K(!0)}})}})]}})}})]}})}})},J=e=>{const r=l(),[t,g]=w(""),[i,d]=k(R),s=async()=>{const n=t().trim();if(!n||i())return;const o=G(n);if(!o.valid)return void K.warning(r(`global.${o.error}`));const l=V(e.parentPath,n),a=await d(l);W(a,()=>{e.onSuccess(l)},()=>{e.onCancel()})};let h;return D(()=>{setTimeout(()=>{h?.focus(),h?.select()},0)}),n(c,{spacing:"$2",w:"$full",pl:"$4",alignItems:"center",get children(){return[n(O,{get color(){return z()},as:B}),n(o,{ref:e=>h=e,get value(){return t()},onInput:e=>g(e.currentTarget.value),get placeholder(){return r("home.toolbar.input_dir_name")},size:"sm",flex:"1",onKeyDown:r=>{"Enter"===r.key?(r.preventDefault(),s()):"Escape"===r.key&&e.onCancel()},onBlur:r=>{if(i())return;const n=r.relatedTarget;"true"!==n?.dataset.folderAction&&(t().trim()||e.onCancel())}}),n(a,{get when(){return!i()},get fallback(){return n(P,{size:"sm",get color(){return z()}})},get children(){return n(u,{get"aria-label"(){return r("global.ok")},size:"sm",variant:"ghost",rounded:"$md",p:"$1",color:"$success9",onClick:s,tabIndex:0,"data-folder-action":"true",get children(){return n(O,{as:L,boxSize:"$6"})}})}}),n(u,{get"aria-label"(){return r("global.cancel")},size:"sm",variant:"ghost",rounded:"$md",p:"$1",color:"$danger9",get onClick(){return e.onCancel},tabIndex:0,"data-folder-action":"true",get children(){return n(O,{as:N,boxSize:"$6"})}})]}})};e("M",e=>{const r=l(),[t,o]=w("/"),[d,b]=w();return m(()=>{e.opened&&d()?.setPath(t())}),"function"==typeof e.defaultValue?m(()=>{o(e.defaultValue())}):"string"==typeof e.defaultValue&&o(e.defaultValue),n(f,{size:"xl",blockScrollOnMount:!1,get opened(){return e.opened},get onClose(){return e.onClose},get children(){return[n(g,{}),n(i,{get children(){return[n(s,{w:"$full",css:{overflowWrap:"break-word"},get children(){return n(c,{w:"$full",justifyContent:"space-between",alignItems:"center",get children(){return[n(C,{css:{overflowWrap:"break-word"},get children(){return e.header}}),n(a,{get when(){return $(()=>!!e.headerSlot)()&&d()},get children(){return e.headerSlot(d())}})]}})}}),n(h,{get children(){return[$(()=>e.children),n(q,{onChange:o,handle:e=>b(e),autoOpen:!0})]}}),n(p,{display:"flex",w:"$full",gap:"$4",alignItems:"flex-end",justifyContent:"flex-end",get children(){return[n(a,{get when(){return e.footerSlot},get children(){return n(C,{mr:"auto",get children(){return e.footerSlot}})}}),n(c,{spacing:"$2",get children(){return[n(u,{get onClick(){return e.onClose},colorScheme:"neutral",get children(){return r("global.cancel")}}),n(u,{get loading(){return e.loading},onClick:()=>e.onSubmit?.(t()),get children(){return r("global.ok")}})]}})]}})]}})]}})}),e("a",e=>{const{isOpen:r,onOpen:w,onClose:b}=t(),C=l();return[n(c,{w:"$full",spacing:"$2",get children(){return[n(o,{get id(){return e.id},get value(){return e.value},onInput:r=>e.onChange(r.currentTarget.value),get readOnly(){return e.onlyFolder},get onClick(){return e.onlyFolder?w:()=>{}},get placeholder(){return C("global."+(e.onlyFolder?"choose_folder":"choose_or_input_path"))}}),n(a,{get when(){return!e.onlyFolder},get children(){return n(u,{onClick:w,get children(){return C("global.choose")}})}})]}}),n(f,{size:"xl",get opened(){return r()},onClose:b,get children(){return[n(g,{}),n(i,{get children(){return[n(d,{}),n(s,{get children(){return C("global.choose_folder")}}),n(h,{get children(){return n(q,{forceRoot:!0,get onChange(){return e.onChange}})}}),n(p,{get children(){return n(u,{onClick:b,get children(){return C("global.confirm")}})}})]}})]}})]})}}});
